package com.web.ddentist.hospital.desk.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import com.web.ddentist.hospital.desk.service.IDeskService;
import com.web.ddentist.vo.PatientVO;
import com.web.ddentist.vo.QuestionnaireVO;

@Controller
@RequestMapping("/hospital/desk")
public class DeskController {
	
	@Autowired
	private IDeskService deskService;
	
	@GetMapping("")
	public String home() {
		return "hospital/desk";
	}
	
	@ResponseBody
	@PostMapping("/insertPatient")
	public String insertPatient(@ModelAttribute PatientVO patientVO) {
		int result = deskService.insertPatient(patientVO);
		if(result == 0) return "FAILED";
		return patientVO.getPtNum();
	}
	
	@ResponseBody
	@PostMapping("/updatePatient")
	public String updatePatient(@ModelAttribute PatientVO patientVO) {
		int result = deskService.updatePatient(patientVO);
		if(result == 0) return "FAILED";
		
		return "UPDATE";
	}
	
	@ResponseBody
	@GetMapping("/searchPatient")
	public List<PatientVO> searchPatient(@RequestParam String keyword){
		List<PatientVO> ptList = deskService.searchPatient(keyword);
		return ptList;
	}
	
	@ResponseBody
	@GetMapping("/selectPatient")
	public PatientVO selectPatient(@RequestParam String ptNum) {
		return deskService.selectPatient(ptNum);
	}
	
	@ResponseBody
	@PostMapping("/deletePatient")
	public String deletePatient (@RequestBody String ptNum) {
		return deskService.deletePatient(ptNum);
	}
	
	@ResponseBody 
	@PostMapping("/insertQue")
	public String insertQue (@ModelAttribute QuestionnaireVO queVO) {
		int result = deskService.insertQue(queVO);
		if(result == 0) return "FAILED";
		return "INSERT";
	}
	
	@ResponseBody 
	@PostMapping("/updateQue")
	public String updateQue (@ModelAttribute QuestionnaireVO queVO) {
		int result = deskService.updateQue(queVO);
		if(result == 0) return "FAILED";
		return "UPDATE";
	}
	
	@ResponseBody
	@GetMapping("/selectPtQue")
	public QuestionnaireVO selectPtQue (@RequestParam String ptNum) {
		return deskService.selectPtQue(ptNum);
	}
	
	
}
